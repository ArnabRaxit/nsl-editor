    <script>
<!--
    $( document ).ready(function() {
console.log('document ready');

    $('#advanced-search-closer').on('click',function(e) {
      console.log('closer');
      $('#advanced-search').addClass('hidden');
    });

    $('#advanced-search-cancel').on('click',function(e) {
      console.log('cancel');
      $('#advanced-search').addClass('hidden');
    });

    $('.advanced-search-button').on('click',function(e) {
      console.log('.advanced-search-button click');
      $('#new-search-field').val($('#query-on').val());
      $('#advanced-search').addClass('hidden');
    });

    $('ul#search-results-tabset li a#advanced-search-tab-container-link').on('click',function(e) {
      debug('advanced-search-tab-container-link clicked; non-advanced containers will be HIDDEN.')
      $('ul#search-results-tabset li').removeClass('active');
      $(this).parent('li').addClass('active');
      $('#advanced-search-container').removeClass('hidden');
      $('#search-result-container').addClass('hidden');
      $('#example-search-container').addClass('hidden');
      $('#search-history-container').addClass('hidden');
      $('#help-search-container').addClass('hidden');
    });

    $('ul#search-results-tabset li a#search-results-tab-container-link').on('click',function(e) {
      debug('search-results-tab-container-link clicked; non-search-result containers will be HIDDEN.')
      $('ul#search-results-tabset li').removeClass('active');
      $(this).parent('li').addClass('active');
      $('#search-result-container').removeClass('hidden');
      $('#advanced-search-container').addClass('hidden');
      $('#example-search-container').addClass('hidden');
      $('#search-history-container').addClass('hidden');
      $('#help-search-container').addClass('hidden');
    });

    $('ul#search-results-tabset li a#example-search-tab-container-link').on('click',function(e) {
      debug('example-search-tab-container-link clicked; non-example containers will be HIDDEN.')
      $('ul#search-results-tabset li').removeClass('active');
      $(this).parent('li').addClass('active');
      $('#search-result-container').addClass('hidden');
      $('#search-result-details').addClass('hidden');
      $('#advanced-search-container').addClass('hidden');
      $('#example-search-container').removeClass('hidden');
      $('#search-history-container').addClass('hidden');
      $('#help-search-container').addClass('hidden');
    });

    $('ul#search-results-tabset li a#search-history-tab-container-link').on('click',function(e) {
      debug('search-history-tab-container-link clicked; non-history containers will be HIDDEN.')
      $('ul#search-results-tabset li').removeClass('active');
      $(this).parent('li').addClass('active');
      $('#search-result-container').addClass('hidden');
      $('#search-result-details').addClass('hidden');
      $('#advanced-search-container').addClass('hidden');
      $('#example-search-container').addClass('hidden');
      $('#search-history-container').removeClass('hidden');
      $('#help-search-container').addClass('hidden');
    });

    $('ul#search-results-tabset li a#help-search-tab-container-link').on('click',function(e) {
      debug('help-search-tab-container-link clicked; non-help containers will be HIDDEN.')
      $('ul#search-results-tabset li').removeClass('active');
      $(this).parent('li').addClass('active');
      $('#search-result-container').addClass('hidden');
      $('#search-result-details').addClass('hidden');
      $('#advanced-search-container').addClass('hidden');
      $('#example-search-container').addClass('hidden');
      $('#search-history-container').addClass('hidden');
      $('#help-search-container').removeClass('hidden');
    });

    $('ul#advanced-search-tabset li a').on('click',function(e) {
      debug('ul#advanced-search-tabset li a clicked; .advanced-search-tab s will be HIDDEN.')
      $('.advanced-search-tab').addClass('hidden');
      $('ul#advanced-search-tabset li').removeClass('active');
      $('#'+$(this).attr('data-show-id')).removeClass('hidden');
      $(this).parent('li').addClass('active');
    });

    $('ul#example-search-tabset li a').on('click',function(e) {
      debug('ul#example-search-tabset li a clicked; .example-search-tab s will be HIDDEN.')
      $('.example-search-tab').addClass('hidden');
      $('ul#example-search-tabset li').removeClass('active');
      $('#'+$(this).attr('data-show-id')).removeClass('hidden');
      $(this).parent('li').addClass('active');
    });


    $('#search-results-tab-container-link').on('click',function(e) {
      $('div#search-result-details').removeClass('hidden');
    });

    $('#advanced-search-tab-container-link').on('click',function(e) {
      debug('#advanced-search-container-link clicked; search-result-details will be HIDDEN.')
      $('div#search-result-details').addClass('hidden');
    });


$( "select#name-advanced-search-name-type-options" )
  .change(function () {
    var str = "";
    $( "select#name-advanced-search-name-type-options option:selected" ).each(function() {
      if (str.trim().length == 0) {
        str = $( this ).val();
      }else{
        str += ", " + $( this ).val() 
      }
    });
    $( "input#name-advanced-search-name-type-list" ).val( str );
  })
  .change();

$( "select#name-advanced-search-list-or-count" )
  .change(function () {
    var val = $(this).val();
    if ( val == 'count' ) {
      /*$("input[id^=name_limited]:radio").attr('disabled',true); */
      $("input#name-advanced-search-set-size").attr('disabled',true);
    } else {
      /* $("input[id^=name_limited]:radio").attr('disabled',false); */
      $("input#name-advanced-search-set-size").attr('disabled',false);
    }

  });

    $("#search-target-list").on("click",function(e) {
        if(e.target && e.target.nodeName == "A") {
            debug('setting search-target');
            document.getElementById('search-target-button-text').innerHTML = e.target.innerHTML;
            document.getElementById('query-target').value = e.target.innerHTML;
            debug(e.target.dataset.help);
            showHelpForSearchTarget(e.target.dataset.help);
            showExamplesForSearchTarget(e.target.dataset.examples);
            showAdvancedForSearchTarget(e.target.dataset.advanced);
        }
    });

  $('a.searchable-field').on('click',function(e) {
    debug('searchable-field clicked');
    $('#query-string-field').val($('#query-string-field').val() + ' ' + $(this).html().replace(/<[^>]*>/g,'').trim());
    $('#query-string-field').focus();
  });

  $('a.search-non-default-tab-link').on('click', function(e) {
    debug('a.search-non-default-tab-link clicked, calling getContentOnDemand for ' + this);
    getContentOnDemand(this);
  });

  setActiveHelpOnLoad();
  setActiveExamplesOnLoad();
  setActiveAdvancedOnLoad();
    
});

-->
    </script>

    <script>
<!--
  function getContentOnDemand(theThis) {
    debug("getContentOnDemand for id: " +$(theThis).attr('id') + " and context: " + $(theThis).attr('data-load-context'));
    var extrasId = $(theThis).attr('data-load-context');
    debug('#'+extrasId);
    var $targetElement = $('#'+extrasId);
    debug("data loaded: " + $targetElement.attr('data-loaded'));
    if ($targetElement.attr('data-loaded') == 'false') {
      debug("Not loaded, so need to load extras: " + extrasId);
      $targetElement.html('Loading...');
      $.get(window.relative_url_root + "/search/extras/"+extrasId, function( data ) {
        debug("get: " + extrasId + " has finished");
        $targetElement.html( data );
        $targetElement.attr('data-loaded','true');
      },'html');
    }

  };

    function showHelpForSearchTarget(helpElement) {
      debug('showHelpForSearchTarget: ' + helpElement);
      $('#help-search-tab-container-link').attr('data-load-context',helpElement);
      debug('HIDING all help');
      $('.search-help').addClass('hidden');
      debug('UNHIDING ' + '#' + helpElement);
      $('#'+helpElement).removeClass('hidden');
      if ($('#help-search-tab-container-link').closest('li').hasClass('active')) {
        $('#help-search-tab-container-link').click();
      };
    }

    function setActiveHelpOnLoad() {
      debug("setActiveHelpOnLoad search-target-button-text: " + $('#search-target-button-text').text().trim());
      var helpId = $('ul#search-target-list li a:containsIgnoreCase(' +  $('#search-target-button-text').text().trim()  + ')').first().attr('data-help');
      showHelpForSearchTarget(helpId);
    }

    function showExamplesForSearchTarget(examplesElement) {
      debug('-----   showExamplesForSearchTarget for ' + examplesElement);
      $('#example-search-tab-container-link').attr('data-load-context',examplesElement);
      $('.search-examples').addClass('hidden');
      $('#'+examplesElement).removeClass('hidden');
      if ($('#example-search-tab-container-link').closest('li').hasClass('active')) {
        $('#example-search-tab-container-link').click();
      };
    }

    function setActiveExamplesOnLoad() {
      var id = $('ul#search-target-list li a:containsIgnoreCase(' +  $('#search-target-button-text').text().trim()  + ')').first().attr('data-examples');
      debug("search-target-button-text: " + $('#search-target-button-text').text().trim());
      debug("setActiveExamplesOnLoad id: " + id);
      showExamplesForSearchTarget(id);
    }

    function showAdvancedForSearchTarget(advancedElement) {
      debug('-----   showAdvancedForSearchTarget: ' + advancedElement);
      $('#advanced-search-tab-container-link').attr('data-load-context',advancedElement);
      $('.search-advanced').addClass('hidden');
      $('#'+advancedElement).removeClass('hidden');
      if ($('#advanced-search-tab-container-link').closest('li').hasClass('active')) {
        $('#advanced-search-tab-container-link').click();
      };
    }

    function setActiveAdvancedOnLoad() {
      var id = $('ul#search-target-list li a:containsIgnoreCase(' +  $('#search-target-button-text').text().trim()  + ')').first().attr('data-advanced');
      showAdvancedForSearchTarget(id);
    }

    function loadNameToString() {
      var str = '';
      if ($('#name-advanced-search-list-or-count').val().trim() == 'count' ) {
        str += $('#name-advanced-search-list-or-count').val().trim();
      }
      if ($('#name-advanced-search-name').val().trim().length > 0) {
        str += ' ';
        str += $('#name-advanced-search-name').val().trim();
      }
      if ($('#name-advanced-search-name-type-list').val().trim().length > 0) {
        str += ' type: ';
        str += $('#name-advanced-search-name-type-list').val().trim();
      }
      if ($('#name_search_name_rank_id').val().trim().length > 0) {
        str += ' ';
        str += $('#name_search_name_rank_id').val().trim();
      }
      if ($('#name-advanced-search-name-rank-list').val().trim().length > 0) {
        str += ' rank: ';
        str += $('#name-advanced-search-name-rank-list').val().trim();
      }
      if ($('#name_search_name_ranked_below').val().trim().length > 0) {
        str += ' ';
        str += $('#name_search_name_ranked_below').val().trim();
      }
      if ($('#name_search_name_ranked_above').val().trim().length > 0) {
        str += ' ';
        str += $('#name_search_name_ranked_above').val().trim();
      }
      if ($('#name_search_name_status_id').val().trim().length > 0) {
        str += ' ';
        str += $('#name_search_name_status_id').val().trim();
      }
      if ($('#name-advanced-search-author-abbrev').val().trim().length > 0) {
        str += ' author: ';
        str += $('#name-advanced-search-author-abbrev').val().trim();
      }
      if ($('#name-advanced-search-ex-author-abbrev').val().trim().length > 0) {
        str += ' ex-author: ';
        str += $('#name-advanced-search-ex-author-abbrev').val().trim();
      }
      if ($('#name-advanced-search-base-author-abbrev').val().trim().length > 0) {
        str += ' base-author: ';
        str += $('#name-advanced-search-base-author-abbrev').val().trim();
      }
      if ($('#name-advanced-search-ex-base-author-abbrev').val().trim().length > 0) {
        str += ' ex-base-author: ';
        str += $('#name-advanced-search-ex-base-author-abbrev').val().trim();
      }
      if ($('#name-advanced-search-sanctioning-author-abbrev').val().trim().length > 0) {
        str += ' sanctioning-author: ';
        str += $('#name-advanced-search-sanctioning-author-abbrev').val().trim();
      }
      if ($('#name-advanced-search-comments').val().trim().length > 0) {
        str += ' comments: ';
        str += $('#name-advanced-search-comments').val().trim();
      }
      if ($('#name-advanced-search-comments-by').val().trim().length > 0) {
        str += ' comments-by: ';
        str += $('#name-advanced-search-comments-by').val().trim();
      }
      $('.name-search-assertion:checked').map(function() {
        str += ' ' + this.value + ' ';
      });
      if ($('#name-advanced-search-set-size').val().trim().length > 0) {
        if ($('#name-advanced-search-list-or-count').val().match(/list/)) {
          str += ' limit:';
          str += $('#name-advanced-search-set-size').val().trim();
        }
      }
      $('#query-string-field').val(str);
    };

-->

    </script>
